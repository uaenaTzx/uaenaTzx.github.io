<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://uaenaTzx.github.io</id>
    <title>Uaena_blog</title>
    <updated>2022-05-10T12:46:11.736Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://uaenaTzx.github.io"/>
    <link rel="self" href="https://uaenaTzx.github.io/atom.xml"/>
    <subtitle>èœç‹—tzxçš„ç¬”è®°åšå®¢ğŸ•</subtitle>
    <logo>https://uaenaTzx.github.io/images/avatar.png</logo>
    <icon>https://uaenaTzx.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, Uaena_blog</rights>
    <entry>
        <title type="html"><![CDATA[Promiseæ‰‹å†™(5)â€”â€”å…¶ä»–æ–¹æ³•å®Œå–„]]></title>
        <id>https://uaenaTzx.github.io/post/promise-shou-xie-5-qi-ta-fang-fa-wan-shan/</id>
        <link href="https://uaenaTzx.github.io/post/promise-shou-xie-5-qi-ta-fang-fa-wan-shan/">
        </link>
        <updated>2022-05-10T06:32:04.000Z</updated>
        <content type="html"><![CDATA[<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®Œå–„Promiseå…¶ä»–å‰©ä½™çš„å†…å®¹</p>
<p><strong>éœ€æ±‚ï¼š</strong></p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>ç»¼ä¸Šï¼Œå†™å‡ºçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code></code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Promiseæ‰‹å†™(4)â€”â€”å¤„ç†é“¾å¼&&å¾ªç¯è°ƒç”¨é—®é¢˜]]></title>
        <id>https://uaenaTzx.github.io/post/promise-shou-xie-4-chu-li-lian-shi-andxun-huan-diao-yong-wen-ti/</id>
        <link href="https://uaenaTzx.github.io/post/promise-shou-xie-4-chu-li-lian-shi-andxun-huan-diao-yong-wen-ti/">
        </link>
        <updated>2022-05-10T06:31:08.000Z</updated>
        <content type="html"><![CDATA[<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å¤„ç†é“¾å¼é—®é¢˜å’Œå¾ªç¯è°ƒç”¨é—®é¢˜</p>
<p><strong>éœ€æ±‚ï¼š</strong><br>
â‘ ä¸Šä¸€ä¸ª.thenè¦è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡<br>
â‘¡ä¸‹ä¸€ä¸ª.thençš„å‚æ•°ï¼Œè¦æ‹¿åˆ°ä¸Šä¸€ä¸ª.thençš„å›è°ƒè¿”å›å€¼<br>
â‘¢è®¾ç½®å‚æ•°xä¸ºonFulfilledæˆåŠŸçš„.thenå›è°ƒçš„è¿”å›å€¼ï¼Œå¹¶é€šè¿‡resolve(x)æ¥è¿›è¡Œé“¾å¼æ“ä½œ</p>
<p><strong>æ³¨æ„ï¼š</strong><font color="red">(çœŸçš„å¾ˆç»•ï¼Œå¥½å¥½ç†è§£ä¸€ä¸‹ğŸ¤¡)</font><br>
â‘ ä»£ç è¿ç”¨äº†é€’å½’çš„æ€æƒ³ï¼Œä¸Šä¸€çº§thenè¿”å›Promsieå¯¹è±¡æ¥å»¶ç»­ä¸‹ä¸€çº§çš„thenï¼Œå› æ­¤éœ€è¦åœ¨thenå‡½æ•°ä¸­æ„é€ ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡å¹¶è¿”å›ï¼Œåœ¨æ–°çš„Promiseå¯¹è±¡ä¸­é€šè¿‡å½“å‰é˜¶æ®µçš„å›è°ƒå‡½æ•°å€¼å†³å®šä¸‹ä¸€æ­¥æ“ä½œ</p>
<p>ç»¼ä¸Šï¼Œå†™å‡ºçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>class Promise {
            constructor(executor) {
                this.state = 'pending'

                this.value = null;
                this.reason = null;

                this.onResolvedCallbacks = [];
                this.onRejectedCallbacks = [];

                const resolve = (value) =&gt; {
                    if (this.state === 'pending') {
                        this.state = 'fulfilled';
                        this.value = value;
                        //éå†æ‰§è¡Œè°ƒç”¨æˆåŠŸçš„æ•°ç»„
                        this.onResolvedCallbacks.forEach(fn =&gt; fn()) //fn()å³ä¸ºå†…éƒ¨å­˜å‚¨çš„å‡½æ•°
                    }
                };

                const reject = (reason) =&gt; {
                    if (this.state === 'pending') {
                        this.state = 'rejected';
                        this.reason = reason;
                        //éå†æ‰§è¡Œè°ƒç”¨å¤±è´¥çš„æ•°ç»„
                        this.onRejectedCallbacks.forEach(fn =&gt; fn())
                    }
                };

                try {
                    executor(resolve, reject);
                } catch (reason) {
                    reject(reason);
                }
            }

            then(onFulfilled, onRejected) {
                let promise2 = new Promise((resolve, reject) =&gt; {
                    //onFulfilledå¦‚æœæˆåŠŸäº†ï¼Œåº”è¯¥è¢«è°ƒç”¨
                    if (this.state === 'fulfilled') {
                        //x æ˜¯onFulfilledæˆåŠŸçš„.thenå›è°ƒçš„è¿”å›å€¼
                        let x = onFulfilled(this.value)
                        //å°†è¿”å›å€¼è¿”å›
                        resolve(x)
                    }
                    //onRejectedå¦‚æœæˆåŠŸäº†ï¼Œåº”è¯¥è¢«è°ƒç”¨
                    if (this.state === 'rejected') {
                        onRejected(this.reason)
                        let x = onRejected(this.reason)
                        reject(x)
                    }

                    if (this.state === 'pending') {
                        //å°†æˆåŠŸçš„æ—¶å€™è¦å¹²çš„äº‹å‚¨å­˜èµ·æ¥
                        this.onResolvedCallbacks.push(() =&gt; {
                            onFulfilled(this.value)
                        })
                        //å°†å¤±è´¥çš„æ—¶å€™è¦å¹²çš„äº‹å‚¨å­˜èµ·æ¥
                        this.onRejectedCallbacks.push(() =&gt; {
                            onRejected(this.reason)
                        })
                    }
                })
                return promise2
            }
        }


        const p = new Promise((resolve, reject) =&gt; {
            //resolveå’Œrejectæ˜¯Promiseå†…éƒ¨å®ç°å¥½çš„å‡½æ•°
            //è¿™é‡Œçš„ä»£ç æ˜¯ç«‹åˆ»å¯æ‰§è¡Œçš„
            resolve(400)

        })

        p.then(res =&gt; {
            console.log(res);
            return 200
            //å†…éƒ¨è½¬åŒ–ä¸ºresolve(200)
        }).then(data =&gt; {
            console.log(data);
        })
</code></pre>
<p>å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</p>
<blockquote>
<p>400<br>
200</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Promiseæ‰‹å†™(3)â€”â€”å¼‚æ­¥é—®é¢˜è§£å†³]]></title>
        <id>https://uaenaTzx.github.io/post/promise-shou-xie-3-yi-bu-wen-ti-jie-jue/</id>
        <link href="https://uaenaTzx.github.io/post/promise-shou-xie-3-yi-bu-wen-ti-jie-jue/">
        </link>
        <updated>2022-05-10T06:30:23.000Z</updated>
        <content type="html"><![CDATA[<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è§£å†³å¼‚æ­¥é—®é¢˜</p>
<p><strong>é—®é¢˜ï¼š</strong><br>
å½“ä»£ç å¦‚ä¸‹æ—¶ï¼š</p>
<pre><code>const p = new Promise((resolve, reject) =&gt; {
            setTimeout(() =&gt; {
                resolve(200)
            }, 1000)
        })

        p.then(res =&gt; {
            console.log(res);
        })
</code></pre>
<p>ä¼šé‡åˆ°then()åœ¨stateçŠ¶æ€æ”¹å˜ä¹‹å‰å°±æ‰§è¡Œï¼Œå¯¼è‡´æ‰§è¡Œthen()æ—¶çš„stateä»ç„¶æ˜¯pendingçŠ¶æ€</p>
<p><strong>éœ€æ±‚ï¼š</strong><br>
â‘ then()çš„æ‰§è¡Œä¸ç›´æ¥è¾“å‡ºç»“æœï¼Œè€Œæ˜¯å°†å¾—åˆ°çš„æ•°æ®å…ˆå…¨éƒ¨å­˜æ”¾åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­ï¼ˆæˆåŠŸå’Œå¤±è´¥ï¼‰ï¼Œåœ¨resolveæˆ–rejectæ‰§è¡Œåå†å°†æ•°ç»„ä¸­çš„å‡½æ•°è¾“å‡º<br>
â‘¡éœ€è¦å¢åŠ ä¸€ä¸ªifåˆ¤æ–­stateå¦‚æœæ˜¯pendingï¼Œå°†æ•°æ®å­˜å‚¨åœ¨æ•°ç»„ä¸­<br>
â‘¢åœ¨resolveå’Œrejectæ–¹æ³•ä¸­éå†ä¸¤æ•°ç»„å¾—åˆ°æ•°æ®</p>
<p><strong>æ³¨æ„ï¼š</strong><font color="red">(è¿™ä¸ªçœŸçš„å¾ˆé‡è¦ï¼ï¼ï¼ğŸ™‰ğŸ™‰ğŸ™‰)</font><br>
â‘ å‡½æ•°åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨éœ€è¦ç”¨åˆ°å‡½æ•°çš„é—­åŒ…(åœ¨å‡½æ•°çš„å†…éƒ¨åº”ç”¨åˆ°å¤–éƒ¨çš„å‚æ•°)â€”â€”åˆ©ç”¨é—­åŒ…å°†valueæˆ–reasonå‚¨å­˜åœ¨å‡½æ•°ä¸­ï¼Œå¹¶æ•´åˆè‡³æ•°ç»„</p>
<pre><code>//é—­åŒ…
this.onResolvedCallbacks.push(() =&gt; {
                        onFulfilled(this.value)
                    })
//éé—­åŒ…
this.onResolvedCallbacks.push(onFulfilledï¼‰
</code></pre>
<p>ç»¼ä¸Šï¼Œå†™å‡ºçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>class Promise {
            constructor(executor) {
                this.state = 'pending'

                this.value = null;
                this.reason = null;

                this.onResolvedCallbacks = [];
                this.onRejectedCallbacks = [];

                const resolve = (value) =&gt; {
                    if (this.state === 'pending') {
                        this.state = 'fulfiled';
                        this.value = value;
                        //éå†æ‰§è¡Œè°ƒç”¨æˆåŠŸçš„æ•°ç»„
                        this.onResolvedCallbacks.forEach(fn =&gt; fn()) //fn()å³ä¸ºå†…éƒ¨å­˜å‚¨çš„å‡½æ•°
                    }
                };

                const reject = (reason) =&gt; {
                    if (this.state === 'pending') {
                        this.state = 'rejected';
                        this.reason = reason;
                        //éå†æ‰§è¡Œè°ƒç”¨å¤±è´¥çš„æ•°ç»„
                        this.onRejectedCallbacks.forEach(fn =&gt; fn())
                    }
                };

                try {
                    executor(resolve, reject);
                } catch (reason) {
                    reject(reason);
                }
            }

            then(onFulfilled, onRejected) {
                //onFulfilledå¦‚æœæˆåŠŸäº†ï¼Œåº”è¯¥è¢«è°ƒç”¨
                if (this.state === 'fulfilled') {
                    onFulfilled(this.value)
                }
                //onRejectedå¦‚æœæˆåŠŸäº†ï¼Œåº”è¯¥è¢«è°ƒç”¨
                if (this.state === 'rejected') {
                    onRejected(this.reason)
                }

                if (this.state === 'pending') {
                    //å°†æˆåŠŸçš„æ—¶å€™è¦å¹²çš„äº‹å‚¨å­˜èµ·æ¥
                    this.onResolvedCallbacks.push(() =&gt; {
                        onFulfilled(this.value)
                    })
                    //å°†å¤±è´¥çš„æ—¶å€™è¦å¹²çš„äº‹å‚¨å­˜èµ·æ¥
                    this.onRejectedCallbacks.push(() =&gt; {
                        onRejected(this.reason)
                    })
                }

            }
        }


        const p = new Promise((resolve, reject) =&gt; {
            //resolveå’Œrejectæ˜¯Promiseå†…éƒ¨å®ç°å¥½çš„å‡½æ•°
            //è¿™é‡Œçš„ä»£ç æ˜¯ç«‹åˆ»å¯æ‰§è¡Œçš„
            setTimeout(() =&gt; {
                resolve(200)
            }, 1000)

        })

        p.then(res =&gt; {
            console.log(res,'1');
        })

        p.then(res =&gt; {
            console.log(res,'2');
        })

        p.then(res =&gt; {
            console.log(res,'3');
        })
</code></pre>
<p>å¾—åˆ°ä»¥ä¸‹ç»“æœ(1så)ï¼š</p>
<blockquote>
<p>200 '1'<br>
200 '2'<br>
200 '3'</p>
</blockquote>
]]></content>
    </entry>
</feed>